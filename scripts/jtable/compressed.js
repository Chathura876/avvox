!function($){var unloadingPage;$(window).on("beforeunload",function(){unloadingPage=!0}),$(window).on("unload",function(){unloadingPage=!1}),$.widget("hik.jtable",{options:{actions:{},fields:{},animationsEnabled:!0,defaultDateFormat:"yy-mm-dd",dialogShowEffect:"fade",dialogHideEffect:"fade",showCloseButton:!1,loadingAnimationDelay:500,saveUserPreferences:!0,jqueryuiTheme:!1,unAuthorizedRequestRedirectUrl:null,ajaxSettings:{type:"POST",dataType:"json"},toolbar:{hoverAnimation:!0,hoverAnimationDuration:60,hoverAnimationEasing:void 0,items:[]},closeRequested:function(event,data){},formCreated:function(event,data){},formSubmitting:function(event,data){},formClosed:function(event,data){},loadingRecords:function(event,data){},recordsLoaded:function(event,data){},rowInserted:function(event,data){},rowsRemoved:function(event,data){},messages:{serverCommunicationError:"An error occured while communicating to the server.",loadingMessage:"Loading records...",noDataAvailable:"No data available!",areYouSure:"Are you sure?",save:"Save",saving:"Saving",cancel:"Cancel",error:"Error",close:"Close",cannotLoadOptionsFor:"Can not load options for field {0}"}},_$mainContainer:null,_$titleDiv:null,_$toolbarDiv:null,_$udaraSearchSpan:null,_$table:null,_$tableBody:null,_$tableRows:null,_$busyDiv:null,_$busyMessageDiv:null,_$errorDialogDiv:null,_columnList:null,_fieldList:null,_keyField:null,_firstDataColumnOffset:0,_lastPostData:null,_cache:null,_create:function(){this._normalizeFieldsOptions(),this._initializeFields(),this._createFieldAndColumnList(),this._createMainContainer(),this._createTableTitle(),this._createToolBar(),this._createSearch(),this._createTable(),this._createBusyPanel(),this._createErrorDialogDiv(),this._addNoDataRow(),this._cookieKeyPrefix=this._generateCookieKeyPrefix()},_normalizeFieldsOptions:function(){var self=this;$.each(self.options.fields,function(fieldName,props){self._normalizeFieldOptions(fieldName,props)})},_normalizeFieldOptions:function(fieldName,props){if(null==props.listClass&&(props.listClass=""),null==props.inputClass&&(props.inputClass=""),props.dependsOn&&"string"===$.type(props.dependsOn)){var dependsOnArray=props.dependsOn.split(",");props.dependsOn=[];for(var i=0;i<dependsOnArray.length;i++)props.dependsOn.push($.trim(dependsOnArray[i]))}},_initializeFields:function(){this._lastPostData={},this._$tableRows=[],this._columnList=[],this._fieldList=[],this._cache=[]},_createFieldAndColumnList:function(){var self=this;$.each(self.options.fields,function(name,props){self._fieldList.push(name),1==props.key&&(self._keyField=name),0!=props.list&&"hidden"!=props.type&&self._columnList.push(name)})},_createMainContainer:function(){this._$mainContainer=$("<div />").addClass("jtable-main-container").appendTo(this.element),this._jqueryuiThemeAddClass(this._$mainContainer,"ui-widget")},_createTableTitle:function(){var self=this;self.options.title;var $titleDiv=$("<div />").addClass("jtable-title").css("height","38px").appendTo(self._$mainContainer);if(self._jqueryuiThemeAddClass($titleDiv,"ui-widget-header"),$("<div />").addClass("jtable-title-text").appendTo($titleDiv).append(self.options.title),self.options.showCloseButton){var $textSpan=$("<span />").html(self.options.messages.close);$("<button></button>").addClass("jtable-command-button jtable-close-button").attr("title",self.options.messages.close).append($textSpan).appendTo($titleDiv).click(function(e){e.preventDefault(),e.stopPropagation(),self._onCloseRequested()})}self._$titleDiv=$titleDiv},_createTable:function(){this._$table=$("<table></table>").addClass("jtable table-responsive table-hover").appendTo(this._$mainContainer),this.options.tableId&&this._$table.attr("id",this.options.tableId),this._jqueryuiThemeAddClass(this._$table,"ui-widget-content"),this._createTableHead(),this._createTableBody()},_createTableHead:function(){var $thead=$("<thead></thead>").appendTo(this._$table);this._addRowToTableHead($thead)},_addRowToTableHead:function($thead){var $tr=$("<tr></tr>").appendTo($thead);this._addColumnsToHeaderRow($tr)},_addColumnsToHeaderRow:function($tr){for(var i=0;i<this._columnList.length;i++){var fieldName=this._columnList[i];this._createHeaderCellForField(fieldName,this.options.fields[fieldName]).appendTo($tr)}},_createHeaderCellForField:function(fieldName,field){field.width=field.width||"10%";var $headerTextSpan=$("<span />").addClass("jtable-column-header-text").html(field.title),$headerContainerDiv=$("<div />").addClass("jtable-column-header-container").append($headerTextSpan),$th=$("<th></th>").addClass("jtable-column-header").addClass(field.listClass).css("width",field.width).css("overflow","hidden").data("fieldName",fieldName).append($headerContainerDiv);return this._jqueryuiThemeAddClass($th,"ui-state-default"),$th},_createEmptyCommandHeader:function(){var $th=$("<th></th>").addClass("jtable-command-column-header").css("width","1%");return this._jqueryuiThemeAddClass($th,"ui-state-default"),$th},_createTableBody:function(){this._$tableBody=$("<tbody></tbody>").appendTo(this._$table)},_createBusyPanel:function(){this._$busyMessageDiv=$("<div />").addClass("jtable-busy-message").prependTo(this._$mainContainer),this._$busyDiv=$("<div />").addClass("jtable-busy-panel-background").prependTo(this._$mainContainer),this._jqueryuiThemeAddClass(this._$busyMessageDiv,"ui-widget-header"),this._hideBusy()},_createErrorDialogDiv:function(){var self=this;self._$errorDialogDiv=$("<div></div>").appendTo(self._$mainContainer),self._$errorDialogDiv.dialog({autoOpen:!1,show:self.options.dialogShowEffect,hide:self.options.dialogHideEffect,modal:!0,title:self.options.messages.error,buttons:[{text:self.options.messages.close,click:function(){self._$errorDialogDiv.dialog("close")}}]})},load:function(postData,completeCallback){this._lastPostData=postData,this._reloadTable(completeCallback)},reload:function(completeCallback){this._reloadTable(completeCallback)},getRowByKey:function(key){for(var i=0;i<this._$tableRows.length;i++)if(key==this._getKeyValueOfRecord(this._$tableRows[i].data("record")))return this._$tableRows[i];return null},destroy:function(){this.element.empty(),$.Widget.prototype.destroy.call(this)},_setOption:function(key,value){},_reloadTable:function(completeCallback){function completeReload(data){self._hideBusy(),"OK"==data.Result?(self._removeAllRows("reloading"),self._addRecordsToTable(data.Records),self._onRecordsLoaded(data),completeCallback&&completeCallback()):self._showError(data.Message)}var self=this;if(self._showBusy(self.options.messages.loadingMessage,self.options.loadingAnimationDelay),self._onLoadingRecords(),$.isFunction(self.options.actions.listAction)){var funcResult=self.options.actions.listAction(self._lastPostData,self._createJtParamsForLoading());self._isDeferredObject(funcResult)?funcResult.done(function(data){completeReload(data)}).fail(function(){self._showError(self.options.messages.serverCommunicationError)}).always(function(){self._hideBusy()}):completeReload(funcResult)}else{var loadUrl=self._createRecordLoadUrl();self._ajax({url:loadUrl,data:self._lastPostData,success:function(data){completeReload(data)},error:function(){self._hideBusy(),self._showError(self.options.messages.serverCommunicationError)}})}},_createRecordLoadUrl:function(){return this.options.actions.listAction},_createJtParamsForLoading:function(){return{}},_createRowFromRecord:function(record){var $tr=$("<tr></tr>").addClass("jtable-data-row").attr("data-record-key",this._getKeyValueOfRecord(record)).data("record",record);return this._addCellsToRowUsingRecord($tr),$tr},_addCellsToRowUsingRecord:function($row){for(var record=$row.data("record"),i=0;i<this._columnList.length;i++)this._createCellForRecordField(record,this._columnList[i]).appendTo($row)},_createCellForRecordField:function(record,fieldName){return $("<td></td>").addClass(this.options.fields[fieldName].listClass).append(this._getDisplayTextForRecordField(record,fieldName))},_addRecordsToTable:function(records){var self=this;$.each(records,function(index,record){self._addRow(self._createRowFromRecord(record))}),self._refreshRowStyles()},_addRowToTable:function($tableRow,index,isNewRow,animationsEnabled){var options={index:this._normalizeNumber(index,0,this._$tableRows.length,this._$tableRows.length)};1==isNewRow&&(options.isNewRow=!0),0==animationsEnabled&&(options.animationsEnabled=!1),this._addRow($tableRow,options)},_addRow:function($row,options){options=$.extend({index:this._$tableRows.length,isNewRow:!1,animationsEnabled:!0},options),this._$tableRows.length<=0&&this._removeNoDataRow(),options.index=this._normalizeNumber(options.index,0,this._$tableRows.length,this._$tableRows.length),options.index==this._$tableRows.length?(this._$tableBody.append($row),this._$tableRows.push($row)):0==options.index?(this._$tableBody.prepend($row),this._$tableRows.unshift($row)):(this._$tableRows[options.index-1].after($row),this._$tableRows.splice(options.index,0,$row)),this._onRowInserted($row,options.isNewRow),options.isNewRow&&(this._refreshRowStyles(),this.options.animationsEnabled&&options.animationsEnabled&&this._showNewRowAnimation($row))},_showNewRowAnimation:function($tableRow){var className="jtable-row-created";this.options.jqueryuiTheme&&(className+=" ui-state-highlight"),$tableRow.addClass(className,"slow","",function(){$tableRow.removeClass(className,5e3)})},_removeRowsFromTable:function($rows,reason){var self=this;$rows.length<=0||($rows.addClass("jtable-row-removed").remove(),$rows.each(function(){var index=self._findRowIndex($(this));0<=index&&self._$tableRows.splice(index,1)}),self._onRowsRemoved($rows,reason),0==self._$tableRows.length&&self._addNoDataRow(),self._refreshRowStyles())},_findRowIndex:function($row){return this._findIndexInArray($row,this._$tableRows,function($row1,$row2){return $row1.data("record")==$row2.data("record")})},_removeAllRows:function(reason){if(!(this._$tableRows.length<=0)){var $rows=this._$tableBody.find("tr.jtable-data-row");this._$tableBody.empty(),this._$tableRows=[],this._onRowsRemoved($rows,reason),this._addNoDataRow()}},_addNoDataRow:function(){if(!(0<this._$tableBody.find(">tr.jtable-no-data-row").length)){var $tr=$("<tr></tr>").addClass("jtable-no-data-row").appendTo(this._$tableBody),totalColumnCount=this._$table.find("thead th").length;$("<td></td>").attr("colspan",totalColumnCount).html(this.options.messages.noDataAvailable).appendTo($tr)}},_removeNoDataRow:function(){this._$tableBody.find(".jtable-no-data-row").remove()},_refreshRowStyles:function(){for(var i=0;i<this._$tableRows.length;i++)i%2==0?this._$tableRows[i].addClass("jtable-row-even"):this._$tableRows[i].removeClass("jtable-row-even")},_getDisplayTextForRecordField:function(record,fieldName){var field=this.options.fields[fieldName],fieldValue=record[fieldName];if(field.display)return field.display({record:record});if("date"==field.type)return this._getDisplayTextForDateRecordField(field,fieldValue);if("checkbox"==field.type)return this._getCheckBoxTextForFieldByValue(fieldName,fieldValue);if(field.options){var options=this._getOptionsForField(fieldName,{record:record,value:fieldValue,source:"list",dependedValues:this._createDependedValuesUsingRecord(record,field.dependsOn)});return this._findOptionByValue(options,fieldValue).DisplayText}return fieldValue},_createDependedValuesUsingRecord:function(record,dependsOn){if(!dependsOn)return{};for(var dependedValues={},i=0;i<dependsOn.length;i++)dependedValues[dependsOn[i]]=record[dependsOn[i]];return dependedValues},_findOptionByValue:function(options,value){for(var i=0;i<options.length;i++)if(options[i].Value==value)return options[i];return{}},_getDisplayTextForDateRecordField:function(field,fieldValue){if(!fieldValue)return"";var displayFormat=field.displayFormat||this.options.defaultDateFormat,date=this._parseDate(fieldValue);return $.datepicker.formatDate(displayFormat,date)},_getOptionsForField:function(fieldName,funcParams){var options,field=this.options.fields[fieldName],optionsSource=field.options;if($.isFunction(optionsSource)&&(optionsSource=optionsSource(funcParams=$.extend(!0,{_cacheCleared:!1,dependedValues:{},clearCache:function(){this._cacheCleared=!0}},funcParams))),"string"==typeof optionsSource){var cacheKey="options_"+fieldName+"_"+optionsSource;if(funcParams._cacheCleared||!this._cache[cacheKey])this._cache[cacheKey]=this._buildOptionsFromArray(this._downloadOptions(fieldName,optionsSource)),this._sortFieldOptions(this._cache[cacheKey],field.optionsSorting);else if(null!=funcParams.value)null==this._findOptionByValue(this._cache[cacheKey],funcParams.value).DisplayText&&(this._cache[cacheKey]=this._buildOptionsFromArray(this._downloadOptions(fieldName,optionsSource)),this._sortFieldOptions(this._cache[cacheKey],field.optionsSorting));options=this._cache[cacheKey]}else options=jQuery.isArray(optionsSource)?this._buildOptionsFromArray(optionsSource):this._buildOptionsArrayFromObject(optionsSource),this._sortFieldOptions(options,field.optionsSorting);return options},_downloadOptions:function(fieldName,url){var self=this,options=[];return self._ajax({url:url,async:!1,success:function(data){"OK"==data.Result?options=data.Options:self._showError(data.Message)},error:function(){var errMessage=self._formatString(self.options.messages.cannotLoadOptionsFor,fieldName);self._showError(errMessage)}}),options},_sortFieldOptions:function(options,sorting){var dataSelector,compareFunc;options&&options.length&&sorting&&(dataSelector=0==sorting.indexOf("value")?function(option){return option.Value}:function(option){return option.DisplayText},compareFunc="string"==$.type(dataSelector(options[0]))?function(option1,option2){return dataSelector(option1).localeCompare(dataSelector(option2))}:function(option1,option2){return dataSelector(option1)-dataSelector(option2)},0<sorting.indexOf("desc")?options.sort(function(a,b){return compareFunc(b,a)}):options.sort(function(a,b){return compareFunc(a,b)}))},_buildOptionsArrayFromObject:function(options){var list=[];return $.each(options,function(propName,propValue){list.push({Value:propName,DisplayText:propValue})}),list},_buildOptionsFromArray:function(optionsArray){for(var list=[],i=0;i<optionsArray.length;i++)$.isPlainObject(optionsArray[i])?list.push(optionsArray[i]):list.push({Value:optionsArray[i],DisplayText:optionsArray[i]});return list},_parseDate:function(dateString){return 0<=dateString.indexOf("Date")?new Date(parseInt(dateString.substr(6),10)):10==dateString.length?new Date(parseInt(dateString.substr(0,4),10),parseInt(dateString.substr(5,2),10)-1,parseInt(dateString.substr(8,2),10)):19==dateString.length?new Date(parseInt(dateString.substr(0,4),10),parseInt(dateString.substr(5,2),10)-1,parseInt(dateString.substr(8,2,10)),parseInt(dateString.substr(11,2),10),parseInt(dateString.substr(14,2),10),parseInt(dateString.substr(17,2),10)):(this._logWarn("Given date is not properly formatted: "+dateString),"format error!")},_createToolBar:function(){this._$toolbarDiv=$("<div />").addClass("jtable-toolbar").appendTo(this._$titleDiv);for(var i=0;i<this.options.toolbar.items.length;i++)this._addToolBarItem(this.options.toolbar.items[i])},_addToolBarItem:function(item){if(null==item||null==item.text&&null==item.icon)return this._logWarn("Can not add tool bar item since it is not valid!"),this._logWarn(item),null;var $toolBarItem=$("<span></span>").addClass("jtable-toolbar-item").appendTo(this._$toolbarDiv);if(this._jqueryuiThemeAddClass($toolBarItem,"ui-widget ui-state-default ui-corner-all","ui-state-hover"),item.cssClass&&$toolBarItem.addClass(item.cssClass),item.tooltip&&$toolBarItem.attr("title",item.tooltip),item.icon){var $icon=$('<span class="jtable-toolbar-item-icon"></span>').appendTo($toolBarItem);!0===item.icon||$.type("string"===item.icon)&&$icon.css("background",'url("'+item.icon+'")')}item.text&&$('<span class=""></span>').html(item.text).addClass("jtable-toolbar-item-text").appendTo($toolBarItem),item.click&&$toolBarItem.click(function(){item.click()});var hoverAnimationDuration=void 0,hoverAnimationEasing=void 0;return this.options.toolbar.hoverAnimation&&(hoverAnimationDuration=this.options.toolbar.hoverAnimationDuration,hoverAnimationEasing=this.options.toolbar.hoverAnimationEasing),$toolBarItem.hover(function(){$toolBarItem.addClass("jtable-toolbar-item-hover",hoverAnimationDuration,hoverAnimationEasing)},function(){$toolBarItem.removeClass("jtable-toolbar-item-hover",hoverAnimationDuration,hoverAnimationEasing)}),$toolBarItem},_createSearch:function(){this._$udaraSearchSpan=$("<span />").append('<input type="text" style="height: 29px" name="name" id="name" placeholder=" Search" />').appendTo(this._$toolbarDiv)},_showError:function(message){this._$errorDialogDiv.html(message).dialog("open")},_setBusyTimer:null,_showBusy:function(message,delay){var self=this;self._$busyDiv.width(self._$mainContainer.width()).height(self._$mainContainer.height()).addClass("jtable-busy-panel-background-invisible").show();function makeVisible(){self._$busyDiv.removeClass("jtable-busy-panel-background-invisible"),self._$busyMessageDiv.html(message).show()}if(delay){if(self._setBusyTimer)return;self._setBusyTimer=setTimeout(makeVisible,delay)}else makeVisible()},_hideBusy:function(){clearTimeout(this._setBusyTimer),this._setBusyTimer=null,this._$busyDiv.hide(),this._$busyMessageDiv.html("").hide()},_isBusy:function(){return this._$busyMessageDiv.is(":visible")},_jqueryuiThemeAddClass:function($elm,className,hoverClassName){this.options.jqueryuiTheme&&($elm.addClass(className),hoverClassName&&$elm.hover(function(){$elm.addClass(hoverClassName)},function(){$elm.removeClass(hoverClassName)}))},_performAjaxCall:function(url,postData,async,success,error){this._ajax({url:url,data:postData,async:async,success:success,error:error})},_unAuthorizedRequestHandler:function(){this.options.unAuthorizedRequestRedirectUrl?location.href=this.options.unAuthorizedRequestRedirectUrl:location.reload(!0)},_ajax:function(options){var self=this,opts={statusCode:{401:function(){self._unAuthorizedRequestHandler()}}};(opts=$.extend(opts,this.options.ajaxSettings,options)).success=function(data){data&&1==data.UnAuthorizedRequest&&self._unAuthorizedRequestHandler(),options.success&&options.success(data)},opts.error=function(jqXHR,textStatus,errorThrown){unloadingPage?jqXHR.abort():options.error&&options.error(arguments)},opts.complete=function(){options.complete&&options.complete()},$.ajax(opts)},_getKeyValueOfRecord:function(record){return record[this._keyField]},_setCookie:function(key,value){key=this._cookieKeyPrefix+key;var expireDate=new Date;expireDate.setDate(expireDate.getDate()+30),document.cookie=encodeURIComponent(key)+"="+encodeURIComponent(value)+"; expires="+expireDate.toUTCString()},_getCookie:function(key){key=this._cookieKeyPrefix+key;for(var equalities=document.cookie.split("; "),i=0;i<equalities.length;i++)if(equalities[i]){var splitted=equalities[i].split("=");if(2==splitted.length&&decodeURIComponent(splitted[0])===key)return decodeURIComponent(splitted[1]||"")}return null},_generateCookieKeyPrefix:function(){var strToHash="";return this.options.tableId&&(strToHash=strToHash+this.options.tableId+"#"),"jtable#"+function(value){var hash=0;if(0==value.length)return hash;for(var i=0;i<value.length;i++){hash=(hash<<5)-hash+value.charCodeAt(i),hash&=hash}return hash}(strToHash=strToHash+this._columnList.join("$")+"#c"+this._$table.find("thead th").length)},_onLoadingRecords:function(){this._trigger("loadingRecords",null,{})},_onRecordsLoaded:function(data){this._trigger("recordsLoaded",null,{records:data.Records,serverResponse:data})},_onRowInserted:function($row,isNewRow){this._trigger("rowInserted",null,{row:$row,record:$row.data("record"),isNewRow:isNewRow})},_onRowsRemoved:function($rows,reason){this._trigger("rowsRemoved",null,{rows:$rows,reason:reason})},_onCloseRequested:function(){this._trigger("closeRequested",null,{})}})}(jQuery),function($){$.extend(!0,$.hik.jtable.prototype,{_getPropertyOfObject:function(obj,propName){if(propName.indexOf(".")<0)return obj[propName];var preDot=propName.substring(0,propName.indexOf(".")),postDot=propName.substring(propName.indexOf(".")+1);return this._getPropertyOfObject(obj[preDot],postDot)},_setPropertyOfObject:function(obj,propName,value){if(propName.indexOf(".")<0)obj[propName]=value;else{var preDot=propName.substring(0,propName.indexOf(".")),postDot=propName.substring(propName.indexOf(".")+1);this._setPropertyOfObject(obj[preDot],postDot,value)}},_insertToArrayIfDoesNotExists:function(array,value){$.inArray(value,array)<0&&array.push(value)},_findIndexInArray:function(value,array,compareFunc){compareFunc=compareFunc||function(a,b){return a==b};for(var i=0;i<array.length;i++)if(compareFunc(value,array[i]))return i;return-1},_normalizeNumber:function(number,min,max,defaultValue){return null==number||null==number||isNaN(number)?defaultValue:number<min?min:max<number?max:number},_formatString:function(){if(0==arguments.length)return null;for(var str=arguments[0],i=1;i<arguments.length;i++){var placeHolder="{"+(i-1)+"}";str=str.replace(placeHolder,arguments[i])}return str},_isDeferredObject:function(obj){return obj.then&&obj.done&&obj.fail},_logDebug:function(text){window.console&&console.log("jTable DEBUG: "+text)},_logInfo:function(text){window.console&&console.log("jTable INFO: "+text)},_logWarn:function(text){window.console&&console.log("jTable WARNING: "+text)},_logError:function(text){window.console&&console.log("jTable ERROR: "+text)}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(elt){var len=this.length,from=Number(arguments[1])||0;for((from=from<0?Math.ceil(from):Math.floor(from))<0&&(from+=len);from<len;from++)if(from in this&&this[from]===elt)return from;return-1})}(jQuery),function($){$.extend(!0,$.hik.jtable.prototype,{_submitFormUsingAjax:function(url,formData,success,error){this._ajax({url:url,data:formData,success:success,error:error})},_createInputLabelForRecordField:function(fieldName){return $("<div />").addClass("jtable-input-label").html(this.options.fields[fieldName].inputTitle||this.options.fields[fieldName].title)},_createInputForRecordField:function(funcParams){var fieldName=funcParams.fieldName,value=funcParams.value,record=funcParams.record,formType=funcParams.formType,form=funcParams.form,field=this.options.fields[fieldName];if(null!=value&&null!=value||(value=field.defaultValue),field.input){var $input=$(field.input({value:value,record:record,formType:formType,form:form}));return $input.attr("id")||$input.attr("id","Edit-"+fieldName),$("<div />").addClass("jtable-input jtable-custom-input").append($input)}return"date"==field.type?this._createDateInputForField(field,fieldName,value):"textarea"==field.type?this._createTextAreaForField(field,fieldName,value):"password"==field.type?this._createPasswordInputForField(field,fieldName,value):"checkbox"==field.type?this._createCheckboxForField(field,fieldName,value):field.options?"radiobutton"==field.type?this._createRadioButtonListForField(field,fieldName,value,record,formType):this._createDropDownListForField(field,fieldName,value,record,formType,form):this._createTextInputForField(field,fieldName,value)},_createInputForHidden:function(fieldName,value){return null==value&&(value=""),$('<input type="hidden" name="'+fieldName+'" id="Edit-'+fieldName+'"></input>').val(value)},_createDateInputForField:function(field,fieldName,value){var $input=$('<input class="'+field.inputClass+'" id="Edit-'+fieldName+'" type="text" name="'+fieldName+'"></input>');null!=value&&$input.val(value);var displayFormat=field.displayFormat||this.options.defaultDateFormat;return $input.datepicker({dateFormat:displayFormat}),$("<div />").addClass("jtable-input jtable-date-input").append($input)},_createTextAreaForField:function(field,fieldName,value){var $textArea=$('<textarea class="'+field.inputClass+'" id="Edit-'+fieldName+'" name="'+fieldName+'"></textarea>');return null!=value&&$textArea.val(value),$("<div />").addClass("jtable-input jtable-textarea-input").append($textArea)},_createTextInputForField:function(field,fieldName,value){var $input=$('<input class="'+field.inputClass+'" id="Edit-'+fieldName+'" type="text" name="'+fieldName+'"></input>');return null!=value&&$input.val(value),$("<div />").addClass("jtable-input jtable-text-input").append($input)},_createPasswordInputForField:function(field,fieldName,value){var $input=$('<input class="'+field.inputClass+'" id="Edit-'+fieldName+'" type="password" name="'+fieldName+'"></input>');return null!=value&&$input.val(value),$("<div />").addClass("jtable-input jtable-password-input").append($input)},_createCheckboxForField:function(field,fieldName,value){var self=this;null==value&&(value=self._getCheckBoxPropertiesForFieldByState(fieldName,!1).Value);var $containerDiv=$("<div />").addClass("jtable-input jtable-checkbox-input"),$checkBox=$('<input class="'+field.inputClass+'" id="Edit-'+fieldName+'" type="checkbox" name="'+fieldName+'" />').appendTo($containerDiv);null!=value&&$checkBox.val(value);var $textSpan=$("<span>"+(field.formText||self._getCheckBoxTextForFieldByValue(fieldName,value))+"</span>").appendTo($containerDiv);self._getIsCheckBoxSelectedForFieldByValue(fieldName,value)&&$checkBox.attr("checked","checked");function refreshCheckBoxValueAndText(){var checkboxProps=self._getCheckBoxPropertiesForFieldByState(fieldName,$checkBox.is(":checked"));$checkBox.attr("value",checkboxProps.Value),$textSpan.html(field.formText||checkboxProps.DisplayText)}return $checkBox.click(function(){refreshCheckBoxValueAndText()}),0!=field.setOnTextClick&&$textSpan.addClass("jtable-option-text-clickable").click(function(){$checkBox.is(":checked")?$checkBox.attr("checked",!1):$checkBox.attr("checked",!0),refreshCheckBoxValueAndText()}),$containerDiv},_createDropDownListForField:function(field,fieldName,value,record,source,form){var $containerDiv=$("<div />").addClass("jtable-input jtable-dropdown-input"),$select=$('<select class="'+field.inputClass+'" id="Edit-'+fieldName+'" name="'+fieldName+'"></select>').appendTo($containerDiv),options=this._getOptionsForField(fieldName,{record:record,source:source,form:form,dependedValues:this._createDependedValuesUsingForm(form,field.dependsOn)});return this._fillDropDownListWithOptions($select,options,value),$containerDiv},_fillDropDownListWithOptions:function($select,options,value){$select.empty();for(var i=0;i<options.length;i++)$("<option"+(options[i].Value==value?' selected="selected"':"")+">"+options[i].DisplayText+"</option>").val(options[i].Value).appendTo($select)},_createDependedValuesUsingForm:function($form,dependsOn){if(!dependsOn)return{};for(var dependedValues={},i=0;i<dependsOn.length;i++){var dependedField=dependsOn[i],$dependsOn=$form.find("select[name="+dependedField+"]");$dependsOn.length<=0||(dependedValues[dependedField]=$dependsOn.val())}return dependedValues},_createRadioButtonListForField:function(field,fieldName,value,record,source){var $containerDiv=$("<div />").addClass("jtable-input jtable-radiobuttonlist-input"),options=this._getOptionsForField(fieldName,{record:record,source:source});return $.each(options,function(i,option){var $radioButtonDiv=$('<div class=""></div>').addClass("jtable-radio-input").appendTo($containerDiv),$radioButton=$('<input type="radio" id="Edit-'+fieldName+"-"+i+'" class="'+field.inputClass+'" name="'+fieldName+'"'+(option.Value==value+""?' checked="true"':"")+" />").val(option.Value).appendTo($radioButtonDiv),$textSpan=$("<span></span>").html(option.DisplayText).appendTo($radioButtonDiv);0!=field.setOnTextClick&&$textSpan.addClass("jtable-option-text-clickable").click(function(){$radioButton.is(":checked")||$radioButton.attr("checked",!0)})}),$containerDiv},_getCheckBoxTextForFieldByValue:function(fieldName,value){return this.options.fields[fieldName].values[value]},_getIsCheckBoxSelectedForFieldByValue:function(fieldName,value){return this._createCheckBoxStateArrayForFieldWithCaching(fieldName)[1].Value.toString()==value.toString()},_getCheckBoxPropertiesForFieldByState:function(fieldName,checked){return this._createCheckBoxStateArrayForFieldWithCaching(fieldName)[checked?1:0]},_createCheckBoxStateArrayForFieldWithCaching:function(fieldName){var cacheKey="checkbox_"+fieldName;return this._cache[cacheKey]||(this._cache[cacheKey]=this._createCheckBoxStateArrayForField(fieldName)),this._cache[cacheKey]},_createCheckBoxStateArrayForField:function(fieldName){var stateArray=[],currentIndex=0;return $.each(this.options.fields[fieldName].values,function(propName,propValue){currentIndex++<2&&stateArray.push({Value:propName,DisplayText:propValue})}),stateArray},_makeCascadeDropDowns:function($form,record,source){var self=this;$form.find("select").each(function(){var $thisDropdown=$(this),fieldName=$thisDropdown.attr("name");if(fieldName){var field=self.options.fields[fieldName];field.dependsOn&&$.each(field.dependsOn,function(index,dependsOnField){$form.find("select[name="+dependsOnField+"]").change(function(){var funcParams={record:record,source:source,form:$form,dependedValues:{}};funcParams.dependedValues=self._createDependedValuesUsingForm($form,field.dependsOn);var options=self._getOptionsForField(fieldName,funcParams);self._fillDropDownListWithOptions($thisDropdown,options,void 0),$thisDropdown.change()})})}})},_updateRecordValuesFromForm:function(record,$form){for(var i=0;i<this._fieldList.length;i++){var fieldName=this._fieldList[i],field=this.options.fields[fieldName];if(0!=field.edit){var $inputElement=$form.find('[name="'+fieldName+'"]');if(!($inputElement.length<=0))if("date"==field.type){var dateVal=$inputElement.val();if(dateVal){var displayFormat=field.displayFormat||this.options.defaultDateFormat;try{var date=$.datepicker.parseDate(displayFormat,dateVal);record[fieldName]="/Date("+date.getTime()+")/"}catch(e){this._logWarn("Date format is incorrect for field "+fieldName+": "+dateVal),record[fieldName]=void 0}}else this._logDebug("Date is empty for "+fieldName),record[fieldName]=void 0}else if(field.options&&"radiobutton"==field.type){var $checkedElement=$inputElement.filter(":checked");$checkedElement.length?record[fieldName]=$checkedElement.val():record[fieldName]=void 0}else record[fieldName]=$inputElement.val()}}},_setEnabledOfDialogButton:function($button,enabled,buttonText){$button&&(0!=enabled?$button.removeAttr("disabled").removeClass("ui-state-disabled"):$button.attr("disabled","disabled").addClass("ui-state-disabled"),buttonText&&$button.find("span").text(buttonText))}})}(jQuery),function($){var base={_create:$.hik.jtable.prototype._create};$.extend(!0,$.hik.jtable.prototype,{options:{recordAdded:function(event,data){},messages:{addNewRecord:"Add new record"}},_$addRecordDiv:null,_create:function(){base._create.apply(this,arguments),this.options.actions.createAction&&this._createAddRecordDialogDiv()},_createAddRecordDialogDiv:function(){var self=this;self._$addRecordDiv=$("<div />").appendTo(self._$mainContainer),self._$addRecordDiv.dialog({autoOpen:!1,show:self.options.dialogShowEffect,hide:self.options.dialogHideEffect,width:"auto",minWidth:"300",modal:!0,title:self.options.messages.addNewRecord,buttons:[{text:self.options.messages.cancel,click:function(){self._$addRecordDiv.dialog("close")}},{id:"AddRecordDialogSaveButton",text:self.options.messages.save,click:function(){self._onSaveClickedOnCreateForm()}}],close:function(){var $addRecordForm=self._$addRecordDiv.find("form").first(),$saveButton=self._$addRecordDiv.parent().find("#AddRecordDialogSaveButton");self._trigger("formClosed",null,{form:$addRecordForm,formType:"create"}),self._setEnabledOfDialogButton($saveButton,!0,self.options.messages.save),$addRecordForm.remove()}}),self.options.addRecordButton?self.options.addRecordButton.click(function(e){e.preventDefault(),self._showAddRecordForm()}):self._addToolBarItem({icon:!0,cssClass:"jtable-toolbar-item-add-record",text:self.options.messages.addNewRecord,click:function(){self._showAddRecordForm()}})},_onSaveClickedOnCreateForm:function(){var $saveButton=this._$addRecordDiv.parent().find("#AddRecordDialogSaveButton"),$addRecordForm=this._$addRecordDiv.find("form");0!=this._trigger("formSubmitting",null,{form:$addRecordForm,formType:"create"})&&(this._setEnabledOfDialogButton($saveButton,!1,this.options.messages.saving),this._saveAddRecordForm($addRecordForm,$saveButton))},showCreateForm:function(){this._showAddRecordForm()},addRecord:function(options){var self=this;if((options=$.extend({clientOnly:!1,animationsEnabled:self.options.animationsEnabled,success:function(){},error:function(){}},options)).record){if(options.clientOnly)return self._addRow(self._createRowFromRecord(options.record),{isNewRow:!0,animationsEnabled:options.animationsEnabled}),void options.success();function completeAddRecord(data){return"OK"!=data.Result?(self._showError(data.Message),void options.error(data)):data.Record?(self._onRecordAdded(data),self._addRow(self._createRowFromRecord(data.Record),{isNewRow:!0,animationsEnabled:options.animationsEnabled}),void options.success(data)):(self._logError("Server must return the created Record object."),void options.error(data))}if(!options.url&&$.isFunction(self.options.actions.createAction)){var funcResult=self.options.actions.createAction($.param(options.record));self._isDeferredObject(funcResult)?funcResult.done(function(data){completeAddRecord(data)}).fail(function(){self._showError(self.options.messages.serverCommunicationError),options.error()}):completeAddRecord(funcResult)}else self._submitFormUsingAjax(options.url||self.options.actions.createAction,$.param(options.record),function(data){completeAddRecord(data)},function(){self._showError(self.options.messages.serverCommunicationError),options.error()})}else self._logWarn("options parameter in addRecord method must contain a record property.")},_showAddRecordForm:function(){for(var self=this,$addRecordForm=$('<form id="jtable-create-form" class="jtable-dialog-form jtable-create-form"></form>'),i=0;i<self._fieldList.length;i++){var fieldName=self._fieldList[i],field=self.options.fields[fieldName];if((1!=field.key||1==field.create)&&0!=field.create)if("hidden"!=field.type){var $fieldContainer=$("<div />").addClass("jtable-input-field-container").appendTo($addRecordForm);$fieldContainer.append(self._createInputLabelForRecordField(fieldName)),$fieldContainer.append(self._createInputForRecordField({fieldName:fieldName,formType:"create",form:$addRecordForm}))}else $addRecordForm.append(self._createInputForHidden(fieldName,field.defaultValue))}self._makeCascadeDropDowns($addRecordForm,void 0,"create"),$addRecordForm.submit(function(){return self._onSaveClickedOnCreateForm(),!1}),self._$addRecordDiv.append($addRecordForm).dialog("open"),self._trigger("formCreated",null,{form:$addRecordForm,formType:"create"})},_saveAddRecordForm:function($addRecordForm,$saveButton){function completeAddRecord(data){return"OK"!=data.Result?(self._showError(data.Message),void self._setEnabledOfDialogButton($saveButton,!0,self.options.messages.save)):data.Record?(self._onRecordAdded(data),self._addRow(self._createRowFromRecord(data.Record),{isNewRow:!0}),void self._$addRecordDiv.dialog("close")):(self._logError("Server must return the created Record object."),void self._setEnabledOfDialogButton($saveButton,!0,self.options.messages.save))}var self=this;if($addRecordForm.data("submitting",!0),$.isFunction(self.options.actions.createAction)){var funcResult=self.options.actions.createAction($addRecordForm.serialize());self._isDeferredObject(funcResult)?funcResult.done(function(data){completeAddRecord(data)}).fail(function(){self._showError(self.options.messages.serverCommunicationError),self._setEnabledOfDialogButton($saveButton,!0,self.options.messages.save)}):completeAddRecord(funcResult)}else self._submitFormUsingAjax(self.options.actions.createAction,$addRecordForm.serialize(),function(data){completeAddRecord(data)},function(){self._showError(self.options.messages.serverCommunicationError),self._setEnabledOfDialogButton($saveButton,!0,self.options.messages.save)})},_onRecordAdded:function(data){this._trigger("recordAdded",null,{record:data.Record,serverResponse:data})}})}(jQuery),function($){var base={_create:$.hik.jtable.prototype._create,_addColumnsToHeaderRow:$.hik.jtable.prototype._addColumnsToHeaderRow,_addCellsToRowUsingRecord:$.hik.jtable.prototype._addCellsToRowUsingRecord};$.extend(!0,$.hik.jtable.prototype,{options:{recordUpdated:function(event,data){},rowUpdated:function(event,data){},messages:{editRecord:"Edit Record"}},_$editDiv:null,_$editingRow:null,_create:function(){base._create.apply(this,arguments),this.options.actions.updateAction&&this._createEditDialogDiv()},_createEditDialogDiv:function(){var self=this;self._$editDiv=$("<div></div>").appendTo(self._$mainContainer),self._$editDiv.dialog({autoOpen:!1,show:self.options.dialogShowEffect,hide:self.options.dialogHideEffect,width:"auto",minWidth:"300",modal:!0,title:self.options.messages.editRecord,buttons:[{text:self.options.messages.cancel,click:function(){self._$editDiv.dialog("close")}},{id:"EditDialogSaveButton",text:self.options.messages.save,click:function(){self._onSaveClickedOnEditForm()}}],close:function(){var $editForm=self._$editDiv.find("form:first"),$saveButton=self._$editDiv.parent().find("#EditDialogSaveButton");self._trigger("formClosed",null,{form:$editForm,formType:"edit",row:self._$editingRow}),self._setEnabledOfDialogButton($saveButton,!0,self.options.messages.save),$editForm.remove()}})},_onSaveClickedOnEditForm:function(){if(this._$editingRow.hasClass("jtable-row-removed"))this._$editDiv.dialog("close");else{var $saveButton=this._$editDiv.parent().find("#EditDialogSaveButton"),$editForm=this._$editDiv.find("form");0!=this._trigger("formSubmitting",null,{form:$editForm,formType:"edit",row:this._$editingRow})&&(this._setEnabledOfDialogButton($saveButton,!1,this.options.messages.saving),this._saveEditForm($editForm,$saveButton))}},updateRecord:function(options){var self=this;if((options=$.extend({clientOnly:!1,animationsEnabled:self.options.animationsEnabled,success:function(){},error:function(){}},options)).record){var key=self._getKeyValueOfRecord(options.record);if(null!=key&&null!=key){var $updatingRow=self.getRowByKey(key);if(null!=$updatingRow){if(options.clientOnly)return $.extend($updatingRow.data("record"),options.record),self._updateRowTexts($updatingRow),self._onRecordUpdated($updatingRow,null),options.animationsEnabled&&self._showUpdateAnimationForRow($updatingRow),void options.success();function completeEdit(data){if("OK"!=data.Result)return self._showError(data.Message),void options.error(data);$.extend($updatingRow.data("record"),options.record),self._updateRecordValuesFromServerResponse($updatingRow.data("record"),data),self._updateRowTexts($updatingRow),self._onRecordUpdated($updatingRow,data),options.animationsEnabled&&self._showUpdateAnimationForRow($updatingRow),options.success(data)}if(!options.url&&$.isFunction(self.options.actions.updateAction)){var funcResult=self.options.actions.updateAction($.param(options.record));self._isDeferredObject(funcResult)?funcResult.done(function(data){completeEdit(data)}).fail(function(){self._showError(self.options.messages.serverCommunicationError),options.error()}):completeEdit(funcResult)}else self._submitFormUsingAjax(options.url||self.options.actions.updateAction,$.param(options.record),function(data){completeEdit(data)},function(){self._showError(self.options.messages.serverCommunicationError),options.error()})}else self._logWarn('Can not found any row by key "'+key+'" on the table. Updating row must be visible on the table.')}else self._logWarn("options parameter in updateRecord method must contain a record that contains the key field property.")}else self._logWarn("options parameter in updateRecord method must contain a record property.")},_addColumnsToHeaderRow:function($tr){base._addColumnsToHeaderRow.apply(this,arguments),null!=this.options.actions.updateAction&&$tr.append(this._createEmptyCommandHeader())},_addCellsToRowUsingRecord:function($row){var self=this;if(base._addCellsToRowUsingRecord.apply(this,arguments),null!=self.options.actions.updateAction){var $span=$("<span></span>").html(self.options.messages.editRecord),$button=$('<button title="'+self.options.messages.editRecord+'"></button>').addClass("jtable-command-button jtable-edit-command-button").append($span).click(function(e){e.preventDefault(),e.stopPropagation(),self._showEditForm($row)});$("<td></td>").addClass("jtable-command-column").append($button).appendTo($row)}},_showEditForm:function($tableRow){for(var self=this,record=$tableRow.data("record"),$editForm=$('<form id="jtable-edit-form" class="jtable-dialog-form jtable-edit-form"></form>'),i=0;i<self._fieldList.length;i++){var fieldName=self._fieldList[i],field=self.options.fields[fieldName],fieldValue=record[fieldName];if(1==field.key){if(1!=field.edit){$editForm.append(self._createInputForHidden(fieldName,fieldValue));continue}$editForm.append(self._createInputForHidden("jtRecordKey",fieldValue))}if(0!=field.edit)if("hidden"!=field.type){var $fieldContainer=$('<div class="jtable-input-field-container"></div>').appendTo($editForm);$fieldContainer.append(self._createInputLabelForRecordField(fieldName));var currentValue=self._getValueForRecordField(record,fieldName);$fieldContainer.append(self._createInputForRecordField({fieldName:fieldName,value:currentValue,record:record,formType:"edit",form:$editForm}))}else $editForm.append(self._createInputForHidden(fieldName,fieldValue))}self._makeCascadeDropDowns($editForm,record,"edit"),$editForm.submit(function(){return self._onSaveClickedOnEditForm(),!1}),self._$editingRow=$tableRow,self._$editDiv.append($editForm).dialog("open"),self._trigger("formCreated",null,{form:$editForm,formType:"edit",record:record,row:$tableRow})},_saveEditForm:function($editForm,$saveButton){function completeEdit(data){if("OK"!=data.Result)return self._showError(data.Message),void self._setEnabledOfDialogButton($saveButton,!0,self.options.messages.save);var record=self._$editingRow.data("record");self._updateRecordValuesFromForm(record,$editForm),self._updateRecordValuesFromServerResponse(record,data),self._updateRowTexts(self._$editingRow),self._$editingRow.attr("data-record-key",self._getKeyValueOfRecord(record)),self._onRecordUpdated(self._$editingRow,data),self.options.animationsEnabled&&self._showUpdateAnimationForRow(self._$editingRow),self._$editDiv.dialog("close")}var self=this;if($.isFunction(self.options.actions.updateAction)){var funcResult=self.options.actions.updateAction($editForm.serialize());self._isDeferredObject(funcResult)?funcResult.done(function(data){completeEdit(data)}).fail(function(){self._showError(self.options.messages.serverCommunicationError),self._setEnabledOfDialogButton($saveButton,!0,self.options.messages.save)}):completeEdit(funcResult)}else self._submitFormUsingAjax(self.options.actions.updateAction,$editForm.serialize(),function(data){completeEdit(data)},function(){self._showError(self.options.messages.serverCommunicationError),self._setEnabledOfDialogButton($saveButton,!0,self.options.messages.save)})},_updateRecordValuesFromServerResponse:function(record,serverResponse){serverResponse&&serverResponse.Record&&$.extend(!0,record,serverResponse.Record)},_getValueForRecordField:function(record,fieldName){var field=this.options.fields[fieldName],fieldValue=record[fieldName];return"date"==field.type?this._getDisplayTextForDateRecordField(field,fieldValue):fieldValue},_updateRowTexts:function($tableRow){for(var record=$tableRow.data("record"),$columns=$tableRow.find("td"),i=0;i<this._columnList.length;i++){var displayItem=this._getDisplayTextForRecordField(record,this._columnList[i]);""!=displayItem&&0==displayItem&&(displayItem="0"),$columns.eq(this._firstDataColumnOffset+i).html(displayItem||"")}this._onRowUpdated($tableRow)},_showUpdateAnimationForRow:function($tableRow){var className="jtable-row-updated";this.options.jqueryuiTheme&&(className+=" ui-state-highlight"),$tableRow.stop(!0,!0).addClass(className,"slow","",function(){$tableRow.removeClass(className,5e3)})},_onRowUpdated:function($row){this._trigger("rowUpdated",null,{row:$row,record:$row.data("record")})},_onRecordUpdated:function($row,data){this._trigger("recordUpdated",null,{record:$row.data("record"),row:$row,serverResponse:data})}})}(jQuery),function($){var base={_create:$.hik.jtable.prototype._create,_addColumnsToHeaderRow:$.hik.jtable.prototype._addColumnsToHeaderRow,_addCellsToRowUsingRecord:$.hik.jtable.prototype._addCellsToRowUsingRecord};$.extend(!0,$.hik.jtable.prototype,{options:{deleteConfirmation:!0,recordDeleted:function(event,data){},messages:{deleteConfirmation:"This record will be deleted. Are you sure?",deleteText:"Delete",deleting:"Deleting",canNotDeletedRecords:"Can not delete {0} of {1} records!",deleteProggress:"Deleting {0} of {1} records, processing..."}},_$deleteRecordDiv:null,_$deletingRow:null,_create:function(){base._create.apply(this,arguments),this._createDeleteDialogDiv()},_createDeleteDialogDiv:function(){var self=this;self.options.actions.deleteAction&&(self._$deleteRecordDiv=$('<div><p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span><span class="jtable-delete-confirm-message"></span></p></div>').appendTo(self._$mainContainer),self._$deleteRecordDiv.dialog({autoOpen:!1,show:self.options.dialogShowEffect,hide:self.options.dialogHideEffect,modal:!0,title:self.options.messages.areYouSure,buttons:[{text:self.options.messages.cancel,click:function(){self._$deleteRecordDiv.dialog("close")}},{id:"DeleteDialogButton",text:self.options.messages.deleteText,click:function(){if(self._$deletingRow.hasClass("jtable-row-removed"))self._$deleteRecordDiv.dialog("close");else{var $deleteButton=self._$deleteRecordDiv.parent().find("#DeleteDialogButton");self._setEnabledOfDialogButton($deleteButton,!1,self.options.messages.deleting),self._deleteRecordFromServer(self._$deletingRow,function(){self._removeRowsFromTableWithAnimation(self._$deletingRow),self._$deleteRecordDiv.dialog("close")},function(message){self._showError(message),self._setEnabledOfDialogButton($deleteButton,!0,self.options.messages.deleteText)})}}}],close:function(){var $deleteButton=self._$deleteRecordDiv.parent().find("#DeleteDialogButton");self._setEnabledOfDialogButton($deleteButton,!0,self.options.messages.deleteText)}}))},deleteRows:function($rows){var self=this;if($rows.length<=0)self._logWarn("No rows specified to jTable deleteRows method.");else if(self._isBusy())self._logWarn("Can not delete rows since jTable is busy!");else if(1!=$rows.length){self._showBusy(self._formatString(self.options.messages.deleteProggress,0,$rows.length));function isCompleted(){return completedCount>=$rows.length}function completed(){var $deletedRows=$rows.filter(".jtable-row-ready-to-remove");$deletedRows.length<$rows.length&&self._showError(self._formatString(self.options.messages.canNotDeletedRecords,$rows.length-$deletedRows.length,$rows.length)),0<$deletedRows.length&&self._removeRowsFromTableWithAnimation($deletedRows),self._hideBusy()}var completedCount=0,deletedCount=0;$rows.each(function(){var $row=$(this);self._deleteRecordFromServer($row,function(){++deletedCount,++completedCount,$row.addClass("jtable-row-ready-to-remove"),self._showBusy(self._formatString(self.options.messages.deleteProggress,deletedCount,$rows.length)),isCompleted()&&completed()},function(){++completedCount,isCompleted()&&completed()})})}else self._deleteRecordFromServer($rows,function(){self._removeRowsFromTableWithAnimation($rows)},function(message){self._showError(message)})},deleteRecord:function(options){var self=this;if(null!=(options=$.extend({clientOnly:!1,animationsEnabled:self.options.animationsEnabled,url:self.options.actions.deleteAction,success:function(){},error:function(){}},options)).key){var $deletingRow=self.getRowByKey(options.key);if(null!=$deletingRow)return options.clientOnly?(self._removeRowsFromTableWithAnimation($deletingRow,options.animationsEnabled),void options.success()):void self._deleteRecordFromServer($deletingRow,function(data){self._removeRowsFromTableWithAnimation($deletingRow,options.animationsEnabled),options.success(data)},function(message){self._showError(message),options.error(message)},options.url);self._logWarn("Can not found any row by key: "+options.key)}else self._logWarn("options parameter in deleteRecord method must contain a key property.")},_addColumnsToHeaderRow:function($tr){base._addColumnsToHeaderRow.apply(this,arguments),null!=this.options.actions.deleteAction&&$tr.append(this._createEmptyCommandHeader())},_addCellsToRowUsingRecord:function($row){base._addCellsToRowUsingRecord.apply(this,arguments);var self=this;if(null!=self.options.actions.deleteAction){var $span=$("<span></span>").html(self.options.messages.deleteText),$button=$('<button title="'+self.options.messages.deleteText+'"></button>').addClass("jtable-command-button jtable-delete-command-button").append($span).click(function(e){e.preventDefault(),e.stopPropagation(),self._deleteButtonClickedForRow($row)});$("<td></td>").addClass("jtable-command-column").append($button).appendTo($row)}},_deleteButtonClickedForRow:function($row){var deleteConfirm,self=this,deleteConfirmMessage=self.options.messages.deleteConfirmation;if($.isFunction(self.options.deleteConfirmation)){var data={row:$row,record:$row.data("record"),deleteConfirm:!0,deleteConfirmMessage:deleteConfirmMessage,cancel:!1,cancelMessage:null};if(self.options.deleteConfirmation(data),data.cancel)return void(data.cancelMessage&&self._showError(data.cancelMessage));deleteConfirmMessage=data.deleteConfirmMessage,deleteConfirm=data.deleteConfirm}else deleteConfirm=self.options.deleteConfirmation;0!=deleteConfirm?(self._$deleteRecordDiv.find(".jtable-delete-confirm-message").html(deleteConfirmMessage),self._showDeleteDialog($row)):self._deleteRecordFromServer($row,function(){self._removeRowsFromTableWithAnimation($row)},function(message){self._showError(message)})},_showDeleteDialog:function($row){this._$deletingRow=$row,this._$deleteRecordDiv.dialog("open")},_deleteRecordFromServer:function($row,success,error,url){function completeDelete(data){if("OK"!=data.Result)return $row.data("deleting",!1),void(error&&error(data.Message));self._trigger("recordDeleted",null,{record:$row.data("record"),row:$row,serverResponse:data}),success&&success(data)}var self=this;if(1!=$row.data("deleting")){$row.data("deleting",!0);var postData={};if(postData[self._keyField]=self._getKeyValueOfRecord($row.data("record")),!url&&$.isFunction(self.options.actions.deleteAction)){var funcResult=self.options.actions.deleteAction(postData);self._isDeferredObject(funcResult)?funcResult.done(function(data){completeDelete(data)}).fail(function(){$row.data("deleting",!1),error&&error(self.options.messages.serverCommunicationError)}):completeDelete(funcResult)}else this._ajax({url:url||self.options.actions.deleteAction,data:postData,success:function(data){completeDelete(data)},error:function(){$row.data("deleting",!1),error&&error(self.options.messages.serverCommunicationError)}})}},_removeRowsFromTableWithAnimation:function($rows,animationsEnabled){var self=this;if(null==animationsEnabled&&(animationsEnabled=self.options.animationsEnabled),animationsEnabled){var className="jtable-row-deleting";this.options.jqueryuiTheme&&(className+=" ui-state-disabled"),$rows.stop(!0,!0).addClass(className,"slow","").promise().done(function(){self._removeRowsFromTable($rows,"deleted")})}else self._removeRowsFromTable($rows,"deleted")}})}(jQuery),function($){var base={_create:$.hik.jtable.prototype._create,_addColumnsToHeaderRow:$.hik.jtable.prototype._addColumnsToHeaderRow,_addCellsToRowUsingRecord:$.hik.jtable.prototype._addCellsToRowUsingRecord,_onLoadingRecords:$.hik.jtable.prototype._onLoadingRecords,_onRecordsLoaded:$.hik.jtable.prototype._onRecordsLoaded,_onRowsRemoved:$.hik.jtable.prototype._onRowsRemoved};$.extend(!0,$.hik.jtable.prototype,{options:{selecting:!1,multiselect:!1,selectingCheckboxes:!1,selectOnRowClick:!0,selectionChanged:function(event,data){}},_selectedRecordIdsBeforeLoad:null,_$selectAllCheckbox:null,_shiftKeyDown:!1,_create:function(){this.options.selecting&&this.options.selectingCheckboxes&&(++this._firstDataColumnOffset,this._bindKeyboardEvents()),base._create.apply(this,arguments)},_bindKeyboardEvents:function(){var self=this;$(document).keydown(function(event){switch(event.which){case 16:self._shiftKeyDown=!0}}).keyup(function(event){switch(event.which){case 16:self._shiftKeyDown=!1}})},selectedRows:function(){return this._getSelectedRows()},selectRows:function($rows){this._selectRows($rows),this._onSelectionChanged()},_addColumnsToHeaderRow:function($tr){this.options.selecting&&this.options.selectingCheckboxes&&(this.options.multiselect?$tr.append(this._createSelectAllHeader()):$tr.append(this._createEmptyCommandHeader())),base._addColumnsToHeaderRow.apply(this,arguments)},_addCellsToRowUsingRecord:function($row){this.options.selecting&&this._makeRowSelectable($row),base._addCellsToRowUsingRecord.apply(this,arguments)},_onLoadingRecords:function(){this.options.selecting&&this._storeSelectionList(),base._onLoadingRecords.apply(this,arguments)},_onRecordsLoaded:function(){this.options.selecting&&this._restoreSelectionList(),base._onRecordsLoaded.apply(this,arguments)},_onRowsRemoved:function($rows,reason){this.options.selecting&&"reloading"!=reason&&0<$rows.filter(".jtable-row-selected").length&&this._onSelectionChanged(),base._onRowsRemoved.apply(this,arguments)},_createSelectAllHeader:function(){var self=this,$columnHeader=$('<th class=""></th>').addClass("jtable-command-column-header jtable-column-header-selecting");this._jqueryuiThemeAddClass($columnHeader,"ui-state-default");var $headerContainer=$("<div />").addClass("jtable-column-header-container").appendTo($columnHeader);return self._$selectAllCheckbox=$('<input type="checkbox" />').appendTo($headerContainer).click(function(){if(self._$tableRows.length<=0)self._$selectAllCheckbox.attr("checked",!1);else{var allRows=self._$tableBody.find(">tr.jtable-data-row");self._$selectAllCheckbox.is(":checked")?self._selectRows(allRows):self._deselectRows(allRows),self._onSelectionChanged()}}),$columnHeader},_storeSelectionList:function(){var self=this;self.options.selecting&&(self._selectedRecordIdsBeforeLoad=[],self._getSelectedRows().each(function(){self._selectedRecordIdsBeforeLoad.push(self._getKeyValueOfRecord($(this).data("record")))}))},_restoreSelectionList:function(){if(this.options.selecting){for(var selectedRowCount=0,i=0;i<this._$tableRows.length;++i){var recordId=this._getKeyValueOfRecord(this._$tableRows[i].data("record"));-1<$.inArray(recordId,this._selectedRecordIdsBeforeLoad)&&(this._selectRows(this._$tableRows[i]),++selectedRowCount)}0<this._selectedRecordIdsBeforeLoad.length&&this._selectedRecordIdsBeforeLoad.length!=selectedRowCount&&this._onSelectionChanged(),this._selectedRecordIdsBeforeLoad=[],this._refreshSelectAllCheckboxState()}},_getSelectedRows:function(){return this._$tableBody.find(">tr.jtable-row-selected")},_makeRowSelectable:function($row){var self=this;if(self.options.selectOnRowClick&&$row.click(function(){self._invertRowSelection($row)}),self.options.selectingCheckboxes){var $cell=$("<td></td>").addClass("jtable-selecting-column"),$selectCheckbox=$('<input type="checkbox" />').appendTo($cell);self.options.selectOnRowClick||$selectCheckbox.click(function(){self._invertRowSelection($row)}),$row.append($cell)}},_invertRowSelection:function($row){if($row.hasClass("jtable-row-selected"))this._deselectRows($row);else if(this._shiftKeyDown){var rowIndex=this._findRowIndex($row),beforeIndex=this._findFirstSelectedRowIndexBeforeIndex(rowIndex)+1;if(0<beforeIndex&&beforeIndex<rowIndex)this._selectRows(this._$tableBody.find("tr").slice(beforeIndex,rowIndex+1));else{var afterIndex=this._findFirstSelectedRowIndexAfterIndex(rowIndex)-1;rowIndex<afterIndex?this._selectRows(this._$tableBody.find("tr").slice(rowIndex,1+afterIndex)):this._selectRows($row)}}else this._selectRows($row);this._onSelectionChanged()},_findFirstSelectedRowIndexBeforeIndex:function(rowIndex){for(var i=rowIndex-1;0<=i;--i)if(this._$tableRows[i].hasClass("jtable-row-selected"))return i;return-1},_findFirstSelectedRowIndexAfterIndex:function(rowIndex){for(var i=rowIndex+1;i<this._$tableRows.length;++i)if(this._$tableRows[i].hasClass("jtable-row-selected"))return i;return-1},_selectRows:function($rows){this.options.multiselect||this._deselectRows(this._getSelectedRows()),$rows.addClass("jtable-row-selected"),this._jqueryuiThemeAddClass($rows,"ui-state-highlight"),this.options.selectingCheckboxes&&$rows.find(">td.jtable-selecting-column >input").prop("checked",!0),this._refreshSelectAllCheckboxState()},_deselectRows:function($rows){$rows.removeClass("jtable-row-selected ui-state-highlight"),this.options.selectingCheckboxes&&$rows.find(">td.jtable-selecting-column >input").prop("checked",!1),this._refreshSelectAllCheckboxState()},_refreshSelectAllCheckboxState:function(){if(this.options.selectingCheckboxes&&this.options.multiselect){var totalRowCount=this._$tableRows.length,selectedRowCount=this._getSelectedRows().length;0==selectedRowCount?(this._$selectAllCheckbox.prop("indeterminate",!1),this._$selectAllCheckbox.attr("checked",!1)):selectedRowCount==totalRowCount?(this._$selectAllCheckbox.prop("indeterminate",!1),this._$selectAllCheckbox.attr("checked",!0)):(this._$selectAllCheckbox.attr("checked",!1),this._$selectAllCheckbox.prop("indeterminate",!0))}},_onSelectionChanged:function(){this._trigger("selectionChanged",null,{})}})}(jQuery),function($){var base={load:$.hik.jtable.prototype.load,_create:$.hik.jtable.prototype._create,_setOption:$.hik.jtable.prototype._setOption,_createRecordLoadUrl:$.hik.jtable.prototype._createRecordLoadUrl,_createJtParamsForLoading:$.hik.jtable.prototype._createJtParamsForLoading,_addRowToTable:$.hik.jtable.prototype._addRowToTable,_addRow:$.hik.jtable.prototype._addRow,_removeRowsFromTable:$.hik.jtable.prototype._removeRowsFromTable,_onRecordsLoaded:$.hik.jtable.prototype._onRecordsLoaded};$.extend(!0,$.hik.jtable.prototype,{options:{paging:!1,pageList:"normal",pageSize:10,pageSizes:[10,25,50,100,250,500],pageSizeChangeArea:!0,gotoPageArea:"combobox",messages:{pagingInfo:"{0}-{1} of {2}",pageSizeChangeLabel:"Per Page",gotoPageLabel:"Page"}},_$bottomPanel:null,_$pagingListArea:null,_$pageSizeChangeArea:null,_$pageInfoSpan:null,_$gotoPageArea:null,_$gotoPageInput:null,_totalRecordCount:0,_currentPageNo:1,_create:function(){base._create.apply(this,arguments),this.options.paging&&(this._loadPagingSettings(),this._createBottomPanel(),this._createPageListArea(),this._createGotoPageInput(),this._createPageSizeSelection())},_loadPagingSettings:function(){if(this.options.saveUserPreferences){var pageSize=this._getCookie("page-size");pageSize&&(this.options.pageSize=this._normalizeNumber(pageSize,1,1e6,this.options.pageSize))}},_createBottomPanel:function(){this._$bottomPanel=$("<div />").addClass("jtable-bottom-panel").insertAfter(this._$table),this._jqueryuiThemeAddClass(this._$bottomPanel,"ui-state-default"),$("<div />").addClass("jtable-left-area").appendTo(this._$bottomPanel),$("<div />").addClass("jtable-right-area").appendTo(this._$bottomPanel)},_createPageListArea:function(){this._$pagingListArea=$("<span></span>").addClass("jtable-page-list").addClass("text-center col-12 col-md-5 col-lg-4").appendTo(this._$bottomPanel.find(".jtable-left-area")),this._$pageInfoSpan=$("<span></span>").addClass("jtable-page-info").addClass("text-center col-12 col-md-2 col-lg-4").appendTo(this._$bottomPanel.find(".jtable-left-area"))},_createPageSizeSelection:function(){var self=this;if(self.options.pageSizeChangeArea){self._findIndexInArray(self.options.pageSize,self.options.pageSizes)<0&&(self.options.pageSizes.push(parseInt(self.options.pageSize)),self.options.pageSizes.sort(function(a,b){return a-b})),self._$pageSizeChangeArea=$("<span></span>").addClass("text-right float-right float-md-none mr-0 float-right col-6 col-md-3 col-lg-2").css("display","inline").appendTo(self._$bottomPanel.find(".jtable-left-area")),self._$pageSizeChangeArea.append("<span>"+self.options.messages.pageSizeChangeLabel+": </span>");for(var $pageSizeChangeCombobox=$("<select></select>").appendTo(self._$pageSizeChangeArea),i=0;i<self.options.pageSizes.length;i++)$pageSizeChangeCombobox.append('<option value="'+self.options.pageSizes[i]+'">'+self.options.pageSizes[i]+"</option>");$pageSizeChangeCombobox.val(self.options.pageSize),$pageSizeChangeCombobox.change(function(){self._changePageSize(parseInt($(this).val()))})}},_createGotoPageInput:function(){var self=this;self.options.gotoPageArea&&"none"!=self.options.gotoPageArea&&(this._$gotoPageArea=$("<span></span>").addClass("col-6 col-md-2 col-lg-2").css("display","inline").appendTo(self._$bottomPanel.find(".jtable-left-area")),this._$gotoPageArea.append("<span>"+self.options.messages.gotoPageLabel+": </span>"),"combobox"==self.options.gotoPageArea?(self._$gotoPageInput=$("<select></select>").appendTo(this._$gotoPageArea).data("pageCount",1).change(function(){self._changePage(parseInt($(this).val()))}),self._$gotoPageInput.append('<option value="1">1</option>')):self._$gotoPageInput=$('<input type="text" maxlength="10" value="'+self._currentPageNo+'" />').appendTo(this._$gotoPageArea).keypress(function(event){if(13==event.which)event.preventDefault(),self._changePage(parseInt(self._$gotoPageInput.val()));else if(43==event.which)event.preventDefault(),self._changePage(parseInt(self._$gotoPageInput.val())+1);else if(45==event.which)event.preventDefault(),self._changePage(parseInt(self._$gotoPageInput.val())-1);else{47<event.keyCode&&event.keyCode<58&&0==event.shiftKey&&0==event.altKey||8==event.keyCode||9==event.keyCode||event.preventDefault()}}))},_refreshGotoPageInput:function(){if(this.options.gotoPageArea&&"none"!=this.options.gotoPageArea){if(this._totalRecordCount<=0?this._$gotoPageArea.hide():this._$gotoPageArea.show(),"combobox"==this.options.gotoPageArea){var oldPageCount=this._$gotoPageInput.data("pageCount"),currentPageCount=this._calculatePageCount();if(oldPageCount!=currentPageCount){this._$gotoPageInput.empty();var pageStep=1;1e4<currentPageCount?pageStep=100:5e3<currentPageCount?pageStep=10:2e3<currentPageCount?pageStep=5:1e3<currentPageCount&&(pageStep=2);for(var i=pageStep;i<=currentPageCount;i+=pageStep)this._$gotoPageInput.append('<option value="'+i+'">'+i+"</option>");this._$gotoPageInput.data("pageCount",currentPageCount)}}this._$gotoPageInput.val(this._currentPageNo)}},load:function(){this._currentPageNo=1,base.load.apply(this,arguments)},_setOption:function(key,value){base._setOption.apply(this,arguments),"pageSize"==key&&this._changePageSize(parseInt(value))},_changePageSize:function(pageSize){if(pageSize!=this.options.pageSize){this.options.pageSize=pageSize;var pageCount=this._calculatePageCount();this._currentPageNo>pageCount&&(this._currentPageNo=pageCount),this._currentPageNo<=0&&(this._currentPageNo=1);var $pageSizeChangeCombobox=this._$bottomPanel.find(".jtable-page-size-change select");if(0<$pageSizeChangeCombobox.length)if(parseInt($pageSizeChangeCombobox.val())!=pageSize)0<$pageSizeChangeCombobox.find("option[value="+pageSize+"]").length&&$pageSizeChangeCombobox.val(pageSize);this._savePagingSettings(),this._reloadTable()}},_savePagingSettings:function(){this.options.saveUserPreferences&&this._setCookie("page-size",this.options.pageSize)},_createRecordLoadUrl:function(){var loadUrl=base._createRecordLoadUrl.apply(this,arguments);return loadUrl=this._addPagingInfoToUrl(loadUrl,this._currentPageNo)},_createJtParamsForLoading:function(){var jtParams=base._createJtParamsForLoading.apply(this,arguments);return this.options.paging&&(jtParams.jtStartIndex=(this._currentPageNo-1)*this.options.pageSize,jtParams.jtPageSize=this.options.pageSize),jtParams},_addRowToTable:function($tableRow,index,isNewRow){isNewRow&&this.options.paging?this._reloadTable():base._addRowToTable.apply(this,arguments)},_addRow:function($row,options){options&&options.isNewRow&&this.options.paging?this._reloadTable():base._addRow.apply(this,arguments)},_removeRowsFromTable:function($rows,reason){base._removeRowsFromTable.apply(this,arguments),this.options.paging&&(this._$tableRows.length<=0&&1<this._currentPageNo&&--this._currentPageNo,this._reloadTable())},_onRecordsLoaded:function(data){this.options.paging&&(this._totalRecordCount=data.TotalRecordCount,this._createPagingList(),this._createPagingInfo(),this._refreshGotoPageInput()),base._onRecordsLoaded.apply(this,arguments)},_addPagingInfoToUrl:function(url,pageNumber){if(!this.options.paging)return url;var jtStartIndex=(pageNumber-1)*this.options.pageSize,jtPageSize=this.options.pageSize;return url+(url.indexOf("?")<0?"?":"&")+"jtStartIndex="+jtStartIndex+"&jtPageSize="+jtPageSize},_createPagingList:function(){if(!(this.options.pageSize<=0||(this._$pagingListArea.empty(),this._totalRecordCount<=0))){var pageCount=this._calculatePageCount();this._createFirstAndPreviousPageButtons(),"normal"==this.options.pageList&&this._createPageNumberButtons(this._calculatePageNumbers(pageCount)),this._createLastAndNextPageButtons(pageCount),this._bindClickEventsToPageNumberButtons()}},_createFirstAndPreviousPageButtons:function(){var $first=$("<span></span>").addClass("jtable-page-number-first").html("&lt&lt").data("pageNumber",1).appendTo(this._$pagingListArea),$previous=$("<span></span>").addClass("jtable-page-number-previous").html("&lt").data("pageNumber",this._currentPageNo-1).appendTo(this._$pagingListArea);this._jqueryuiThemeAddClass($first,"ui-button ui-state-default","ui-state-hover"),this._jqueryuiThemeAddClass($previous,"ui-button ui-state-default","ui-state-hover"),this._currentPageNo<=1&&($first.addClass("jtable-page-number-disabled"),$previous.addClass("jtable-page-number-disabled"),this._jqueryuiThemeAddClass($first,"ui-state-disabled"),this._jqueryuiThemeAddClass($previous,"ui-state-disabled"))},_createLastAndNextPageButtons:function(pageCount){var $next=$("<span></span>").addClass("jtable-page-number-next").html("&gt").data("pageNumber",this._currentPageNo+1).appendTo(this._$pagingListArea),$last=$("<span></span>").addClass("jtable-page-number-last").html("&gt&gt").data("pageNumber",pageCount).appendTo(this._$pagingListArea);this._jqueryuiThemeAddClass($next,"ui-button ui-state-default","ui-state-hover"),this._jqueryuiThemeAddClass($last,"ui-button ui-state-default","ui-state-hover"),this._currentPageNo>=pageCount&&($next.addClass("jtable-page-number-disabled"),$last.addClass("jtable-page-number-disabled"),this._jqueryuiThemeAddClass($next,"ui-state-disabled"),this._jqueryuiThemeAddClass($last,"ui-state-disabled"))},_createPageNumberButtons:function(pageNumbers){for(var previousNumber=0,i=0;i<pageNumbers.length;i++)1<pageNumbers[i]-previousNumber&&$("<span></span>").addClass("jtable-page-number-space").html("...").appendTo(this._$pagingListArea),this._createPageNumberButton(pageNumbers[i]),previousNumber=pageNumbers[i]},_createPageNumberButton:function(pageNumber){var $pageNumber=$("<span></span>").addClass("jtable-page-number").html(pageNumber).data("pageNumber",pageNumber).appendTo(this._$pagingListArea);this._jqueryuiThemeAddClass($pageNumber,"ui-button ui-state-default","ui-state-hover"),this._currentPageNo==pageNumber&&($pageNumber.addClass("jtable-page-number-active jtable-page-number-disabled"),this._jqueryuiThemeAddClass($pageNumber,"ui-state-active"))},_calculatePageCount:function(){var pageCount=Math.floor(this._totalRecordCount/this.options.pageSize);return this._totalRecordCount%this.options.pageSize!=0&&++pageCount,pageCount},_calculatePageNumbers:function(pageCount){if(pageCount<=4){for(var pageNumbers=[],i=1;i<=pageCount;++i)pageNumbers.push(i);return pageNumbers}var shownPageNumbers=[1,2,pageCount-1,pageCount],previousPageNo=this._normalizeNumber(this._currentPageNo-1,1,pageCount,1),nextPageNo=this._normalizeNumber(this._currentPageNo+1,1,pageCount,1);return this._insertToArrayIfDoesNotExists(shownPageNumbers,previousPageNo),this._insertToArrayIfDoesNotExists(shownPageNumbers,this._currentPageNo),this._insertToArrayIfDoesNotExists(shownPageNumbers,nextPageNo),shownPageNumbers.sort(function(a,b){return a-b}),shownPageNumbers},_createPagingInfo:function(){if(this._totalRecordCount<=0)this._$pageInfoSpan.empty();else{var startNo=(this._currentPageNo-1)*this.options.pageSize+1,endNo=this._currentPageNo*this.options.pageSize;if(startNo<=(endNo=this._normalizeNumber(endNo,startNo,this._totalRecordCount,0))){var pagingInfoMessage=this._formatString(this.options.messages.pagingInfo,startNo,endNo,this._totalRecordCount);this._$pageInfoSpan.html(pagingInfoMessage)}}},_bindClickEventsToPageNumberButtons:function(){var self=this;self._$pagingListArea.find(".jtable-page-number,.jtable-page-number-previous,.jtable-page-number-next,.jtable-page-number-first,.jtable-page-number-last").not(".jtable-page-number-disabled").click(function(e){e.preventDefault(),self._changePage($(this).data("pageNumber"))})},_changePage:function(pageNo){(pageNo=this._normalizeNumber(pageNo,1,this._calculatePageCount(),1))!=this._currentPageNo?(this._currentPageNo=pageNo,this._reloadTable()):this._refreshGotoPageInput()}})}(jQuery),function($){var base={_initializeFields:$.hik.jtable.prototype._initializeFields,_normalizeFieldOptions:$.hik.jtable.prototype._normalizeFieldOptions,_createHeaderCellForField:$.hik.jtable.prototype._createHeaderCellForField,_createRecordLoadUrl:$.hik.jtable.prototype._createRecordLoadUrl,_createJtParamsForLoading:$.hik.jtable.prototype._createJtParamsForLoading};$.extend(!0,$.hik.jtable.prototype,{options:{sorting:!1,multiSorting:!1,defaultSorting:""},_lastSorting:null,_initializeFields:function(){base._initializeFields.apply(this,arguments),this._lastSorting=[],this.options.sorting&&this._buildDefaultSortingArray()},_normalizeFieldOptions:function(fieldName,props){base._normalizeFieldOptions.apply(this,arguments),props.sorting=0!=props.sorting},_createHeaderCellForField:function(fieldName,field){var $headerCell=base._createHeaderCellForField.apply(this,arguments);return this.options.sorting&&field.sorting&&this._makeColumnSortable($headerCell,fieldName),$headerCell},_createRecordLoadUrl:function(){var loadUrl=base._createRecordLoadUrl.apply(this,arguments);return loadUrl=this._addSortingInfoToUrl(loadUrl)},_buildDefaultSortingArray:function(){var self=this;$.each(self.options.defaultSorting.split(","),function(orderIndex,orderValue){$.each(self.options.fields,function(fieldName,fieldProps){if(fieldProps.sorting){var colOffset=orderValue.indexOf(fieldName);-1<colOffset&&(-1<orderValue.toUpperCase().indexOf(" DESC",colOffset)?self._lastSorting.push({fieldName:fieldName,sortOrder:"DESC"}):self._lastSorting.push({fieldName:fieldName,sortOrder:"ASC"}))}})})},_makeColumnSortable:function($columnHeader,fieldName){var self=this;$columnHeader.addClass("jtable-column-header-sortable").click(function(e){e.preventDefault(),self.options.multiSorting&&e.ctrlKey||(self._lastSorting=[]),self._sortTableByColumn($columnHeader)}),$.each(this._lastSorting,function(sortIndex,sortField){sortField.fieldName==fieldName&&("DESC"==sortField.sortOrder?$columnHeader.addClass("jtable-column-header-sorted-desc"):$columnHeader.addClass("jtable-column-header-sorted-asc"))})},_sortTableByColumn:function($columnHeader){0==this._lastSorting.length&&$columnHeader.siblings().removeClass("jtable-column-header-sorted-asc jtable-column-header-sorted-desc");for(var i=0;i<this._lastSorting.length;i++)this._lastSorting[i].fieldName==$columnHeader.data("fieldName")&&this._lastSorting.splice(i--,1);$columnHeader.hasClass("jtable-column-header-sorted-asc")?($columnHeader.removeClass("jtable-column-header-sorted-asc").addClass("jtable-column-header-sorted-desc"),this._lastSorting.push({fieldName:$columnHeader.data("fieldName"),sortOrder:"DESC"})):($columnHeader.removeClass("jtable-column-header-sorted-desc").addClass("jtable-column-header-sorted-asc"),this._lastSorting.push({fieldName:$columnHeader.data("fieldName"),sortOrder:"ASC"})),this._reloadTable()},_addSortingInfoToUrl:function(url){if(!this.options.sorting||0==this._lastSorting.length)return url;var sorting=[];return $.each(this._lastSorting,function(idx,value){sorting.push(value.fieldName+" "+value.sortOrder)}),url+(url.indexOf("?")<0?"?":"&")+"jtSorting="+sorting.join(",")},_createJtParamsForLoading:function(){var jtParams=base._createJtParamsForLoading.apply(this,arguments);if(this.options.sorting&&this._lastSorting.length){var sorting=[];$.each(this._lastSorting,function(idx,value){sorting.push(value.fieldName+" "+value.sortOrder)}),jtParams.jtSorting=sorting.join(",")}return jtParams}})}(jQuery),function($){var base={_create:$.hik.jtable.prototype._create,_normalizeFieldOptions:$.hik.jtable.prototype._normalizeFieldOptions,_createHeaderCellForField:$.hik.jtable.prototype._createHeaderCellForField,_createCellForRecordField:$.hik.jtable.prototype._createCellForRecordField};$.extend(!0,$.hik.jtable.prototype,{options:{tableId:void 0,columnResizable:!0,columnSelectable:!0},_$columnSelectionDiv:null,_$columnResizeBar:null,_cookieKeyPrefix:null,_currentResizeArgs:null,_create:function(){base._create.apply(this,arguments),this._createColumnResizeBar(),this._createColumnSelection(),this.options.saveUserPreferences&&this._loadColumnSettings(),this._normalizeColumnWidths()},_normalizeFieldOptions:function(fieldName,props){base._normalizeFieldOptions.apply(this,arguments),this.options.columnResizable&&(props.columnResizable=0!=props.columnResizable),props.visibility||(props.visibility="visible")},_createHeaderCellForField:function(fieldName,field){var $headerCell=base._createHeaderCellForField.apply(this,arguments);return this.options.columnResizable&&field.columnResizable&&fieldName!=this._columnList[this._columnList.length-1]&&this._makeColumnResizable($headerCell),"hidden"==field.visibility&&$headerCell.hide(),$headerCell},_createCellForRecordField:function(record,fieldName){var $column=base._createCellForRecordField.apply(this,arguments);return"hidden"==this.options.fields[fieldName].visibility&&$column.hide(),$column},changeColumnVisibility:function(columnName,visibility){this._changeColumnVisibilityInternal(columnName,visibility),this._normalizeColumnWidths(),this.options.saveUserPreferences&&this._saveColumnSettings()},_changeColumnVisibilityInternal:function(columnName,visibility){var columnIndex=this._columnList.indexOf(columnName);if(columnIndex<0)this._logWarn('Column "'+columnName+'" does not exist in fields!');else if(["visible","hidden","fixed"].indexOf(visibility)<0)this._logWarn('Visibility value is not valid: "'+visibility+'"! Options are: visible, hidden, fixed.');else{var field=this.options.fields[columnName];if(field.visibility!=visibility){var columnIndexInTable=this._firstDataColumnOffset+columnIndex+1;"hidden"!=field.visibility&&"hidden"==visibility?this._$table.find(">thead >tr >th:nth-child("+columnIndexInTable+"),>tbody >tr >td:nth-child("+columnIndexInTable+")").hide():"hidden"==field.visibility&&"hidden"!=visibility&&this._$table.find(">thead >tr >th:nth-child("+columnIndexInTable+"),>tbody >tr >td:nth-child("+columnIndexInTable+")").show().css("display","table-cell"),field.visibility=visibility}}},_createColumnSelection:function(){var self=this;this._$columnSelectionDiv=$("<div />").addClass("jtable-column-selection-container").appendTo(self._$mainContainer),this._$table.children("thead").bind("contextmenu",function(e){if(self.options.columnSelectable){e.preventDefault(),$("<div />").addClass("jtable-contextmenu-overlay").click(function(){$(this).remove(),self._$columnSelectionDiv.hide()}).bind("contextmenu",function(){return!1}).appendTo(document.body),self._fillColumnSelection();var containerOffset=self._$mainContainer.offset(),selectionDivTop=e.pageY-containerOffset.top,selectionDivLeft=e.pageX-containerOffset.left,containerWidth=self._$mainContainer.width();100<containerWidth&&containerWidth-100<selectionDivLeft&&(selectionDivLeft=containerWidth-100),self._$columnSelectionDiv.css({left:selectionDivLeft,top:selectionDivTop,"min-width":"100px"}).show()}})},_fillColumnSelection:function(){for(var self=this,$columnsUl=$("<ul></ul>").addClass("jtable-column-select-list"),i=0;i<this._columnList.length;i++){var columnName=this._columnList[i],field=this.options.fields[columnName],$columnLi=$("<li></li>").appendTo($columnsUl),$label=$('<label for="'+columnName+'"></label>').append($("<span>"+(field.title||columnName)+"</span>")).appendTo($columnLi),$checkbox=$('<input type="checkbox" name="'+columnName+'">').prependTo($label).click(function(){var $clickedCheckbox=$(this),clickedColumnName=$clickedCheckbox.attr("name");"fixed"!=self.options.fields[clickedColumnName].visibility&&self.changeColumnVisibility(clickedColumnName,$clickedCheckbox.is(":checked")?"visible":"hidden")});"hidden"!=field.visibility&&$checkbox.attr("checked","checked"),"fixed"==field.visibility&&$checkbox.attr("disabled","disabled")}this._$columnSelectionDiv.html($columnsUl)},_createColumnResizeBar:function(){this._$columnResizeBar=$("<div />").addClass("jtable-column-resize-bar").appendTo(this._$mainContainer).hide()},_makeColumnResizable:function($columnHeader){var self=this;$("<div />").addClass("jtable-column-resize-handler").appendTo($columnHeader.find(".jtable-column-header-container")).mousedown(function(downevent){downevent.preventDefault(),downevent.stopPropagation();var mainContainerOffset=self._$mainContainer.offset(),$nextColumnHeader=$columnHeader.nextAll("th.jtable-column-header:visible:first");if($nextColumnHeader.length){self._currentResizeArgs={currentColumnStartWidth:$columnHeader.outerWidth(),minWidth:10,maxWidth:$columnHeader.outerWidth()+$nextColumnHeader.outerWidth()-10,mouseStartX:downevent.pageX,minResizeX:function(){return this.mouseStartX-(this.currentColumnStartWidth-this.minWidth)},maxResizeX:function(){return this.mouseStartX+(this.maxWidth-this.currentColumnStartWidth)}};function resizeonmousemove(moveevent){if(self._currentResizeArgs){var resizeBarX=self._normalizeNumber(moveevent.pageX,self._currentResizeArgs.minResizeX(),self._currentResizeArgs.maxResizeX());self._$columnResizeBar.css("left",resizeBarX-mainContainerOffset.left+"px")}}var resizeonmouseup=function(upevent){if(self._currentResizeArgs){$(document).unbind("mousemove",resizeonmousemove),$(document).unbind("mouseup",resizeonmouseup),self._$columnResizeBar.hide();var mouseChangeX=upevent.pageX-self._currentResizeArgs.mouseStartX,currentColumnFinalWidth=self._normalizeNumber(self._currentResizeArgs.currentColumnStartWidth+mouseChangeX,self._currentResizeArgs.minWidth,self._currentResizeArgs.maxWidth),nextColumnFinalWidth=$nextColumnHeader.outerWidth()+(self._currentResizeArgs.currentColumnStartWidth-currentColumnFinalWidth),pixelToPercentRatio=$columnHeader.data("width-in-percent")/self._currentResizeArgs.currentColumnStartWidth;$columnHeader.data("width-in-percent",currentColumnFinalWidth*pixelToPercentRatio),$nextColumnHeader.data("width-in-percent",nextColumnFinalWidth*pixelToPercentRatio),$columnHeader.css("width",$columnHeader.data("width-in-percent")+"%"),$nextColumnHeader.css("width",$nextColumnHeader.data("width-in-percent")+"%"),self._normalizeColumnWidths(),self._currentResizeArgs=null,self.options.saveUserPreferences&&self._saveColumnSettings()}};self._$columnResizeBar.show().css({top:$columnHeader.offset().top-mainContainerOffset.top+"px",left:downevent.pageX-mainContainerOffset.left+"px",height:self._$table.outerHeight()+"px"}),$(document).bind("mousemove",resizeonmousemove),$(document).bind("mouseup",resizeonmouseup)}})},_normalizeColumnWidths:function(){var commandColumnHeaders=this._$table.find(">thead th.jtable-command-column-header").data("width-in-percent",1).css("width","1%"),headerCells=this._$table.find(">thead th.jtable-column-header"),totalWidthInPixel=0;headerCells.each(function(){var $cell=$(this);$cell.is(":visible")&&(totalWidthInPixel+=$cell.outerWidth())});var columnWidhts={},availableWidthInPercent=100-commandColumnHeaders.length;headerCells.each(function(){var $cell=$(this);if($cell.is(":visible")){var fieldName=$cell.data("fieldName"),widthInPercent=$cell.outerWidth()*availableWidthInPercent/totalWidthInPixel;columnWidhts[fieldName]=widthInPercent}}),headerCells.each(function(){var $cell=$(this);if($cell.is(":visible")){var fieldName=$cell.data("fieldName");$cell.data("width-in-percent",columnWidhts[fieldName]).css("width",columnWidhts[fieldName]+"%")}})},_saveColumnSettings:function(){var self=this,fieldSettings="";this._$table.find(">thead >tr >th.jtable-column-header").each(function(){var $cell=$(this),fieldName=$cell.data("fieldName"),columnWidth=$cell.data("width-in-percent"),fieldVisibility=self.options.fields[fieldName].visibility;fieldSettings=fieldSettings+(fieldName+"="+fieldVisibility+";"+columnWidth)+"|"}),this._setCookie("column-settings",fieldSettings.substr(0,fieldSettings.length-1))},_loadColumnSettings:function(){var self=this,columnSettingsCookie=this._getCookie("column-settings");if(columnSettingsCookie){var columnSettings={};$.each(columnSettingsCookie.split("|"),function(inx,fieldSetting){var splitted=fieldSetting.split("="),fieldName=splitted[0],settings=splitted[1].split(";");columnSettings[fieldName]={columnVisibility:settings[0],columnWidth:settings[1]}}),this._$table.find(">thead >tr >th.jtable-column-header").each(function(){var $cell=$(this),fieldName=$cell.data("fieldName"),field=self.options.fields[fieldName];columnSettings[fieldName]&&("fixed"!=field.visibility&&self._changeColumnVisibilityInternal(fieldName,columnSettings[fieldName].columnVisibility),$cell.data("width-in-percent",columnSettings[fieldName].columnWidth).css("width",columnSettings[fieldName].columnWidth+"%"))})}}})}(jQuery),function($){var base={_removeRowsFromTable:$.hik.jtable.prototype._removeRowsFromTable};$.extend(!0,$.hik.jtable.prototype,{options:{openChildAsAccordion:!1},openChildTable:function($row,tableOptions,opened){var self=this;null==tableOptions.jqueryuiTheme&&(tableOptions.jqueryuiTheme=self.options.jqueryuiTheme),tableOptions.showCloseButton=0!=tableOptions.showCloseButton,tableOptions.showCloseButton&&!tableOptions.closeRequested&&(tableOptions.closeRequested=function(){self.closeChildTable($row)}),self.options.openChildAsAccordion&&$row.siblings(".jtable-data-row").each(function(){self.closeChildTable($(this))}),self.closeChildTable($row,function(){var $childRowColumn=self.getChildRow($row).children("td").empty(),$childTableContainer=$("<div />").addClass("jtable-child-table-container").appendTo($childRowColumn);$childRowColumn.data("childTable",$childTableContainer),$childTableContainer.jtable(tableOptions),self.openChildRow($row),$childTableContainer.hide().slideDown("fast",function(){opened&&opened({childTable:$childTableContainer})})})},closeChildTable:function($row,closed){var self=this,$childRowColumn=this.getChildRow($row).children("td"),$childTable=$childRowColumn.data("childTable");$childTable?($childRowColumn.data("childTable",null),$childTable.slideUp("fast",function(){$childTable.jtable("destroy"),$childTable.remove(),self.closeChildRow($row),closed&&closed()})):closed&&closed()},isChildRowOpen:function($row){return this.getChildRow($row).is(":visible")},getChildRow:function($row){return $row.data("childRow")||this._createChildRow($row)},openChildRow:function($row){var $childRow=this.getChildRow($row);return $childRow.is(":visible")||$childRow.show(),$childRow},closeChildRow:function($row){var $childRow=this.getChildRow($row);$childRow.is(":visible")&&$childRow.hide()},_removeRowsFromTable:function($rows,reason){"deleted"==reason&&$rows.each(function(){var $childRow=$(this).data("childRow");$childRow&&$childRow.remove()}),base._removeRowsFromTable.apply(this,arguments)},_createChildRow:function($row){var totalColumnCount=this._$table.find("thead th").length,$childRow=$("<tr></tr>").addClass("jtable-child-row").append('<td colspan="'+totalColumnCount+'"></td>');return $row.after($childRow),$row.data("childRow",$childRow),$childRow.hide(),$childRow}})}(jQuery);